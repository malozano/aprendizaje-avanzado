<!DOCTYPE html><html lang="es" class="no-js"><head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Apuntes de la asignatura Aprendizaje Avanzado del Grado en Ingeniería en Inteligencia Artificial de la Universidad de Alicante">
      
      
        <meta name="author" content="Miguel Angel Lozano">
      
      
        <link rel="canonical" href="https://malozano.github.io/aprendizaje-avanzado/practicas/00-datos-y-visualizacion/">
      
      
        <link rel="prev" href="../../03-arboles-decision/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.1">
    
    
      
        <title>0. Datos y visualización - Aprendizaje Avanzado</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.402914a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"><script src="../../assets/javascripts/glightbox.min.js"></script><style id="glightbox-style">
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#clase-0-flujo-completo-de-machine-learning-de-datos-a-modelo" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../.." title="Aprendizaje Avanzado" class="md-header__button md-logo" aria-label="Aprendizaje Avanzado" data-md-component="logo">
      
  <img src="../../images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Aprendizaje Avanzado
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              0. Datos y visualización
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo" aria-label="Modo oscuro" type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Modo oscuro" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg>
            </label>
          
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="white" data-md-color-accent="blue" aria-label="Modo claro" type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Modo claro" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Aprendizaje Avanzado" class="md-nav__button md-logo" aria-label="Aprendizaje Avanzado" data-md-component="logo">
      
  <img src="../../images/logo.png" alt="logo">

    </a>
    Aprendizaje Avanzado
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Introducción
      </a>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2">
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Bloque I. Aprendizaje supervisado
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Bloque I. Aprendizaje supervisado
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../01-modelos-no-param/" class="md-nav__link">
        1. Modelos paramétricos y no paramétricos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../02-svm/" class="md-nav__link">
        2. SVM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../03-arboles-decision/" class="md-nav__link">
        3. Árboles de decisión
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Prácticas
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Prácticas
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          0. Datos y visualización
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        0. Datos y visualización
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-preprocesamiento-de-datos" class="md-nav__link">
    1. Preprocesamiento de Datos
  </a>
  
    <nav class="md-nav" aria-label="1. Preprocesamiento de Datos">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-exploracion-inicial-y-tipos-de-datos" class="md-nav__link">
    1.1 Exploración Inicial y Tipos de Datos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-manejo-de-valores-faltantes" class="md-nav__link">
    1.2 Manejo de Valores Faltantes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-tratamiento-de-outliers" class="md-nav__link">
    1.3 Tratamiento de Outliers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14-transformacion-de-variables" class="md-nav__link">
    1.4 Transformación de Variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-codificacion-de-variables-categoricas" class="md-nav__link">
    1.5 Codificación de Variables Categóricas
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-analisis-exploratorio-de-datos-eda" class="md-nav__link">
    2. Análisis Exploratorio de Datos (EDA)
  </a>
  
    <nav class="md-nav" aria-label="2. Análisis Exploratorio de Datos (EDA)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-estadistica-descriptiva" class="md-nav__link">
    2.1 Estadística Descriptiva
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-distribuciones-univariadas" class="md-nav__link">
    2.2 Distribuciones Univariadas
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-box-plots" class="md-nav__link">
    2.3 Box Plots
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-relaciones-bivariadas" class="md-nav__link">
    2.4 Relaciones Bivariadas
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25-scatter-plots" class="md-nav__link">
    2.5 Scatter Plots
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#26-multicolinealidad" class="md-nav__link">
    2.6 Multicolinealidad
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#27-imbalance-y-representatividad" class="md-nav__link">
    2.7 Imbalance y Representatividad
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#28-patrones-anomalias-e-insights" class="md-nav__link">
    2.8 Patrones, Anomalías e Insights
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-train-test-split-y-estandarizacion" class="md-nav__link">
    3. Train-Test Split y Estandarización
  </a>
  
    <nav class="md-nav" aria-label="3. Train-Test Split y Estandarización">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-separacion-train-test" class="md-nav__link">
    3.1 Separación Train-Test
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-estandarizacion-del-conjunto-de-entrenamiento" class="md-nav__link">
    3.2 Estandarización del Conjunto de Entrenamiento
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-modelo-regresion-logistica" class="md-nav__link">
    3.3 Modelo: Regresión Logística
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-metricas-de-clasificacion" class="md-nav__link">
    3.4 Métricas de Clasificación
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35-validacion-cruzada" class="md-nav__link">
    3.5 Validación Cruzada
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-pipelines-en-machine-learning" class="md-nav__link">
    4. Pipelines en Machine Learning
  </a>
  
    <nav class="md-nav" aria-label="4. Pipelines en Machine Learning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-por-que-pipelines" class="md-nav__link">
    4.1 ¿Por qué Pipelines?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-pipeline-basico" class="md-nav__link">
    4.2 Pipeline Básico
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-columntransformer-para-multiples-tipos-de-datos" class="md-nav__link">
    4.3 ColumnTransformer (para múltiples tipos de datos)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-pipeline-con-gridsearchcv" class="md-nav__link">
    4.4 Pipeline con GridSearchCV
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#45-ventajas-de-pipelines-tabla-resumen" class="md-nav__link">
    4.5 Ventajas de Pipelines - Tabla Resumen
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-tareas-para-casa" class="md-nav__link">
    5. Tareas para Casa
  </a>
  
    <nav class="md-nav" aria-label="5. Tareas para Casa">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objetivo" class="md-nav__link">
    Objetivo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#opciones-de-dataset" class="md-nav__link">
    Opciones de Dataset
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#estructura-de-entrega" class="md-nav__link">
    Estructura de Entrega
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="clase-0-flujo-completo-de-machine-learning-de-datos-a-modelo">Clase 0: Flujo Completo de Machine Learning - De Datos a Modelo<a class="headerlink" href="#clase-0-flujo-completo-de-machine-learning-de-datos-a-modelo" title="Permanent link">¶</a></h1>
<div class="admonition info">
<p class="admonition-title">Contexto</p>
<p>Esta es la clase inaugural de Aprendizaje Avanzado. Cubriremos el flujo end-to-end de un problema de ML: desde datos crudos hasta un modelo desplegado y rastreado. No nos enfocamos en implementación, sino en <strong>por qué</strong> cada paso importa.</p>
</div>
<hr>
<h2 id="1-preprocesamiento-de-datos">1. Preprocesamiento de Datos<a class="headerlink" href="#1-preprocesamiento-de-datos" title="Permanent link">¶</a></h2>
<p>El preprocesamiento es donde invertirás el 60-70% del tiempo en un proyecto real de ML. Es tentador saltárselo, pero <strong>un buen preprocesamiento es la diferencia entre un modelo mediocre y uno excelente</strong>.</p>
<h3 id="11-exploracion-inicial-y-tipos-de-datos">1.1 Exploración Inicial y Tipos de Datos<a class="headerlink" href="#11-exploracion-inicial-y-tipos-de-datos" title="Permanent link">¶</a></h3>
<p><strong>¿Qué hacemos aquí?</strong></p>
<p>Lo primero es entender qué tenemos entre manos. Necesitas responder:</p>
<ul>
<li>¿Cuántas muestras y características tengo?</li>
<li>¿Qué tipo de datos son? (numéricas, categóricas, de fecha, texto)</li>
<li>¿Hay valores faltantes? ¿Cuántos?</li>
<li>¿Cuál es mi variable objetivo?</li>
</ul>
<p><strong>¿Por qué importa?</strong></p>
<p>Diferentes tipos de datos requieren diferentes tratamientos. Una variable categórica no se puede alimentar directamente a sklearn. Los valores faltantes pueden sesgar tu modelo. Los tipos incorrectos causan errores silenciosos.</p>
<p><strong>En la práctica:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Cargar datos</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'./datasets/Iris.csv'</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="c1"># Dimensiones</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="nb">print</span><span class="p">(</span><span class="s2">"*"</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Shape: </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>  <span class="c1"># (150, 5)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="nb">print</span><span class="p">(</span><span class="s2">"*"</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="c1"># Tipos de datos</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="nb">print</span><span class="p">(</span><span class="s2">"*"</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="c1"># Primeras filas</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="nb">print</span><span class="p">(</span><span class="s2">"*"</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="c1"># Resumen rápido</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="nb">print</span><span class="p">(</span><span class="s2">"*"</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="c1"># Valores faltantes</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</code></pre></div>
<p><strong>Output esperado para Iris:</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>****************************************
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>Shape: (150, 6)
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>****************************************
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>Id                 int64
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>SepalLengthCm    float64
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>SepalWidthCm     float64
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>PetalLengthCm    float64
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>PetalWidthCm     float64
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>Species           object
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>dtype: object
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>****************************************
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>   Id  SepalLengthCm  SepalWidthCm  PetalLengthCm  PetalWidthCm      Species
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>0   1            5.1           3.5            1.4           0.2  Iris-setosa
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>1   2            4.9           3.0            1.4           0.2  Iris-setosa
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>2   3            4.7           3.2            1.3           0.2  Iris-setosa
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>3   4            4.6           3.1            1.5           0.2  Iris-setosa
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>4   5            5.0           3.6            1.4           0.2  Iris-setosa
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>****************************************
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>&lt;class 'pandas.core.frame.DataFrame'&gt;
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a>RangeIndex: 150 entries, 0 to 149
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a>Data columns (total 6 columns):
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a> #   Column         Non-Null Count  Dtype  
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a>---  ------         --------------  -----  
<a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a> 0   Id             150 non-null    int64  
<a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a> 1   SepalLengthCm  150 non-null    float64
<a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a> 2   SepalWidthCm   150 non-null    float64
<a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a> 3   PetalLengthCm  150 non-null    float64
<a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a> 4   PetalWidthCm   150 non-null    float64
<a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a> 5   Species        150 non-null    object 
<a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a>dtypes: float64(4), int64(1), object(1)
<a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a>memory usage: 7.2+ KB
<a id="__codelineno-1-32" name="__codelineno-1-32" href="#__codelineno-1-32"></a>None
<a id="__codelineno-1-33" name="__codelineno-1-33" href="#__codelineno-1-33"></a>****************************************
<a id="__codelineno-1-34" name="__codelineno-1-34" href="#__codelineno-1-34"></a>Id               0
<a id="__codelineno-1-35" name="__codelineno-1-35" href="#__codelineno-1-35"></a>SepalLengthCm    0
<a id="__codelineno-1-36" name="__codelineno-1-36" href="#__codelineno-1-36"></a>SepalWidthCm     0
<a id="__codelineno-1-37" name="__codelineno-1-37" href="#__codelineno-1-37"></a>PetalLengthCm    0
<a id="__codelineno-1-38" name="__codelineno-1-38" href="#__codelineno-1-38"></a>PetalWidthCm     0
<a id="__codelineno-1-39" name="__codelineno-1-39" href="#__codelineno-1-39"></a>Species          0
<a id="__codelineno-1-40" name="__codelineno-1-40" href="#__codelineno-1-40"></a>dtype: int64
</code></pre></div><p></p>
<p><strong>Nota importante:</strong> Iris no tiene valores faltantes (es por eso que es un dataset "juguete"). En la vida real, rara vez verás datos tan limpios.</p>
<hr>
<h3 id="12-manejo-de-valores-faltantes">1.2 Manejo de Valores Faltantes<a class="headerlink" href="#12-manejo-de-valores-faltantes" title="Permanent link">¶</a></h3>
<p><strong>¿Qué son y por qué aparecen?</strong></p>
<p>Valores faltantes (NaN, None) aparecen por:
- Errores en la recopilación
- Equipos que no registraron datos
- Confidencialidad (datos intencionalmente omitidos)
- Procesos de limpieza anteriores</p>
<p><strong>Estrategias de manejo:</strong></p>
<table>
<thead>
<tr>
<th>Estrategia</th>
<th>Cuándo usar</th>
<th>Ventajas</th>
<th>Desventajas</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Eliminación de fila</strong></td>
<td>&lt;5% de datos faltantes en esa fila</td>
<td>Simple, limpio</td>
<td>Pierdes información</td>
</tr>
<tr>
<td><strong>Eliminación de columna</strong></td>
<td>&gt;50% de valores faltantes</td>
<td>Limpio</td>
<td>Pierdes feature</td>
</tr>
<tr>
<td><strong>Imputación por media/mediana</strong></td>
<td>Datos numéricos, MCAR*</td>
<td>Rápido</td>
<td>Reduce varianza, sesgado</td>
</tr>
<tr>
<td><strong>Imputación por forward fill</strong></td>
<td>Series temporales</td>
<td>Preserva contexto</td>
<td>Solo para datos ordenados</td>
</tr>
<tr>
<td><strong>Métodos avanzados (KNN, IterativeImputer)</strong></td>
<td>Datos con patrones</td>
<td>Más preciso</td>
<td>Computacionalmente caro</td>
</tr>
</tbody>
</table>
<p>*MCAR = Missing Completely At Random</p>
<p><strong>Ejemplo conceptual:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1"># Chequear valores faltantes</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="n">missing</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">missing</span><span class="p">)</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="c1"># Estrategia 1: Eliminar filas con cualquier faltante</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="n">df_clean</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="c1"># Estrategia 2: Eliminar columnas con &gt;50% faltantes</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="n">df_clean</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">thresh</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="c1"># Estrategia 3: Imputación</span>
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="n">df_imputed</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>  <span class="c1"># numéricas</span>
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="n">df_imputed</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># categóricas</span>
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a><span class="c1"># Estrategia 4: Imputación avanzada (sklearn)</span>
<a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a><span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">SimpleImputer</span><span class="p">,</span> <span class="n">KNNImputer</span>
<a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>
<a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a><span class="n">imputer</span> <span class="o">=</span> <span class="n">KNNImputer</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a><span class="n">df_imputed</span> <span class="o">=</span> <span class="n">imputer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</code></pre></div>
<p><strong>Decisión crítica:</strong> La estrategia que elijas introduce sesgo. Documentalo siempre.</p>
<hr>
<h3 id="13-tratamiento-de-outliers">1.3 Tratamiento de Outliers<a class="headerlink" href="#13-tratamiento-de-outliers" title="Permanent link">¶</a></h3>
<p><strong>¿Qué son outliers?</strong></p>
<p>Valores que se desvían significativamente del resto de la distribución. Pueden ser:
- <strong>Errores reales:</strong> Tipográficos, sensores rotos
- <strong>Valores legítimos:</strong> Comportamientos extremos pero reales (ej: un cliente que compra 1000 veces)</p>
<p><strong>Métodos de detección:</strong></p>
<table>
<thead>
<tr>
<th>Método</th>
<th>Fórmula/Criterio</th>
<th>Cuándo usar</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Desviación estándar</strong></td>
<td>μ ± 3σ</td>
<td>Datos normales</td>
</tr>
<tr>
<td><strong>IQR</strong></td>
<td>Q1 - 1.5×IQR, Q3 + 1.5×IQR</td>
<td>Datos sesgados, robusta</td>
</tr>
<tr>
<td><strong>Z-score</strong></td>
<td>|z| &gt; 3</td>
<td>Datos normalizados</td>
</tr>
<tr>
<td><strong>Visualización</strong></td>
<td>Box plots, scatter plots</td>
<td>Siempre, como primer paso</td>
</tr>
</tbody>
</table>
<p><strong>Ejemplo:</strong></p>
<p></p><div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="c1"># Detección por IQR</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="n">Q1</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'SepalLengthCm'</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="n">Q3</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'SepalLengthCm'</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="n">IQR</span> <span class="o">=</span> <span class="n">Q3</span> <span class="o">-</span> <span class="n">Q1</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="n">outliers</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'SepalLengthCm'</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">Q1</span> <span class="o">-</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">IQR</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'SepalLengthCm'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Q3</span> <span class="o">+</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">IQR</span><span class="p">)</span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Outliers detectados: </span><span class="si">{</span><span class="n">outliers</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="c1"># Visualización</span>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="c1"># Box plot</span>
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'SepalLengthCm'</span><span class="p">])</span>
<a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Box Plot - Sepal Length'</span><span class="p">)</span>
<a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Valor'</span><span class="p">)</span>
<a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a>
<a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a><span class="c1"># Scatter plot</span>
<a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)),</span> <span class="n">df</span><span class="p">[</span><span class="s1">'SepalLengthCm'</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">())</span>
<a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Distribución de valores'</span><span class="p">)</span>
<a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Sepal Length (ordenado)'</span><span class="p">)</span>
<a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a>
<a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a><span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'./images/outliers_detection.png'</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">'tight'</span><span class="p">)</span>
<a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a><span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>
Output esperado: 
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../images/outliers_detection.png" data-desc-position="bottom"><img alt="Detección de Outliers" src="../images/outliers_detection.png"></a><p></p>
<div class="admonition warning">
<p class="admonition-title">¿Eliminar o transformar?</p>
<ul>
<li><strong>Elimina si:</strong> Es claramente un error (ej: edad = -5 años)</li>
<li><strong>Transforma si:</strong> Es extremo pero legítimo. Usa transformaciones (log, raíz cuadrada) para reducir su impacto sin perder información</li>
</ul>
</div>
<hr>
<h3 id="14-transformacion-de-variables">1.4 Transformación de Variables<a class="headerlink" href="#14-transformacion-de-variables" title="Permanent link">¶</a></h3>
<p><strong>Normalización vs Estandarización:</strong></p>
<p>Ambas escalan los datos, pero de formas diferentes:</p>
<table>
<thead>
<tr>
<th>Técnica</th>
<th>Fórmula</th>
<th>Rango</th>
<th>Cuándo usar</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Normalización (Min-Max)</strong></td>
<td>(x - min) / (max - min)</td>
<td>[0, 1]</td>
<td>Cuando sabes el rango y quieres limites fijos</td>
</tr>
<tr>
<td><strong>Estandarización (Z-score)</strong></td>
<td>(x - μ) / σ</td>
<td>Aproximadamente [-1, 1]</td>
<td>Por defecto para modelos lineales, SVM, NN</td>
</tr>
<tr>
<td><strong>Robust Scaling</strong></td>
<td>(x - Q2) / IQR</td>
<td>-</td>
<td>Cuando hay outliers (menos sensible)</td>
</tr>
</tbody>
</table>
<p><strong>¿Por qué es crítico?</strong></p>
<p>Algoritmos como regresión logística, SVM y redes neuronales son <strong>sensibles a la escala</strong>. Una característica con rango [0, 10000] domina sobre otra en [0, 1]. El modelo aprenderá más lentamente o convergerá a soluciones subóptimas.</p>
<p><strong>Ejemplo:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">MinMaxScaler</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="c1"># Valores originales</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="nb">print</span><span class="p">(</span><span class="s2">"*"</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="nb">print</span><span class="p">(</span><span class="s2">"Valores originales:"</span><span class="p">)</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Min: </span><span class="si">{</span><span class="n">df</span><span class="p">[[</span><span class="s1">'SepalLengthCm'</span><span class="p">,</span><span class="w"> </span><span class="s1">'SepalWidthCm'</span><span class="p">,</span><span class="w"> </span><span class="s1">'PetalLengthCm'</span><span class="p">,</span><span class="w"> </span><span class="s1">'PetalWidthCm'</span><span class="p">]]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Max: </span><span class="si">{</span><span class="n">df</span><span class="p">[[</span><span class="s1">'SepalLengthCm'</span><span class="p">,</span><span class="w"> </span><span class="s1">'SepalWidthCm'</span><span class="p">,</span><span class="w"> </span><span class="s1">'PetalLengthCm'</span><span class="p">,</span><span class="w"> </span><span class="s1">'PetalWidthCm'</span><span class="p">]]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="nb">print</span><span class="p">(</span><span class="s2">"*"</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="c1"># Estandarización (recomendado para modelos lineales)</span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="n">X_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">'SepalLengthCm'</span><span class="p">,</span> <span class="s1">'SepalWidthCm'</span><span class="p">,</span> <span class="s1">'PetalLengthCm'</span><span class="p">,</span> <span class="s1">'PetalWidthCm'</span><span class="p">]])</span>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="c1"># Después de estandarizar, cada feature tiene media=0 y std=1</span>
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Media: </span><span class="si">{</span><span class="n">X_scaled</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>  <span class="c1"># ~0</span>
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Std: </span><span class="si">{</span><span class="n">X_scaled</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>     <span class="c1"># ~1</span>
<a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a><span class="nb">print</span><span class="p">(</span><span class="s2">"*"</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
<a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a><span class="c1"># Normalización (alternativa)</span>
<a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a><span class="n">normalizer</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a><span class="n">X_normalized</span> <span class="o">=</span> <span class="n">normalizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">'SepalLengthCm'</span><span class="p">,</span> <span class="s1">'SepalWidthCm'</span><span class="p">,</span> <span class="s1">'PetalLengthCm'</span><span class="p">,</span> <span class="s1">'PetalWidthCm'</span><span class="p">]])</span>
<a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a>
<a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a><span class="c1"># Rango: [0, 1]</span>
<a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Min: </span><span class="si">{</span><span class="n">X_normalized</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Max: </span><span class="si">{</span><span class="n">X_normalized</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a><span class="nb">print</span><span class="p">(</span><span class="s2">"*"</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
</code></pre></div>
<h3 id="15-codificacion-de-variables-categoricas">1.5 Codificación de Variables Categóricas<a class="headerlink" href="#15-codificacion-de-variables-categoricas" title="Permanent link">¶</a></h3>
<p><strong>El problema:</strong> Los modelos numéricos no entienden "setosa", "versicolor", "virginica".</p>
<p><strong>Dos enfoques principales:</strong></p>
<table>
<thead>
<tr>
<th>Técnica</th>
<th>Ejemplo</th>
<th>Cuándo usar</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Label Encoding</strong></td>
<td>setosa → 0, versicolor → 1, virginica → 2</td>
<td>Variables <strong>ordinales</strong> (pequeño &lt; medio &lt; grande)</td>
</tr>
<tr>
<td><strong>One-Hot Encoding</strong></td>
<td>setosa → [1,0,0], versicolor → [0,1,0], virginica → [0,0,1]</td>
<td>Variables <strong>nominales</strong> (sin orden natural)</td>
</tr>
</tbody>
</table>
<p><strong>¿Por qué importa la elección?</strong></p>
<p>Con Label Encoding, le dices al modelo "2 &gt; 1 &gt; 0". Eso introduce un orden falso en variables sin orden natural, sesgando el aprendizaje.</p>
<p><strong>Ejemplo:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="c1"># Label Encoding (solo si es ordinal)</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="n">le</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="n">df</span><span class="p">[</span><span class="s1">'species_encoded'</span><span class="p">]</span> <span class="o">=</span> <span class="n">le</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'Species'</span><span class="p">])</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="c1"># setosa → 0, versicolor → 1, virginica → 2</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="c1"># One-Hot Encoding (para nominales - RECOMENDADO para Iris)</span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="n">df_encoded</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'Species'</span><span class="p">],</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="c1"># Crea: species_versicolor, species_virginica (drop_first evita multicolinealidad)</span>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="nb">print</span><span class="p">(</span><span class="n">df_encoded</span><span class="o">.</span><span class="n">tail</span><span class="p">())</span>
</code></pre></div>
<p><strong>Output:</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>Id  SepalLengthCm  SepalWidthCm  PetalLengthCm  PetalWidthCm  \
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>145  146            6.7           3.0            5.2           2.3   
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>146  147            6.3           2.5            5.0           1.9   
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>147  148            6.5           3.0            5.2           2.0   
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>148  149            6.2           3.4            5.4           2.3   
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>149  150            5.9           3.0            5.1           1.8   
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>     species_encoded  Species_encoded  Species_Iris-versicolor  \
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>145                2                2                    False   
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>146                2                2                    False   
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>147                2                2                    False   
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>148                2                2                    False   
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a>149                2                2                    False   
<a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a>
<a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>     Species_Iris-virginica  
<a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a>145                    True  
<a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a>146                    True  
<a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a>147                    True  
<a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a>148                    True  
<a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a>149                    True
</code></pre></div><p></p>
<div class="admonition tip">
<p class="admonition-title">One-Hot Encoding: drop_first=True</p>
<p>Con 3 clases, necesitas solo 2 variables dummy. La tercera es redundante (si no es versicolor ni virginica, es setosa). Omitirla evita <strong>multicolinealidad perfecta</strong>.</p>
</div>
<hr>
<h2 id="2-analisis-exploratorio-de-datos-eda">2. Análisis Exploratorio de Datos (EDA)<a class="headerlink" href="#2-analisis-exploratorio-de-datos-eda" title="Permanent link">¶</a></h2>
<p>El EDA es donde empiezas a <strong>entender tus datos</strong> y a generar hipótesis. Es detective work.</p>
<h3 id="21-estadistica-descriptiva">2.1 Estadística Descriptiva<a class="headerlink" href="#21-estadistica-descriptiva" title="Permanent link">¶</a></h3>
<p><strong>¿Qué números resumidos nos dicen los datos?</strong></p>
<p></p><div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c1"># Resumen rápido</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</code></pre></div>
<strong>Output para Iris:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>Id  SepalLengthCm  SepalWidthCm  PetalLengthCm  PetalWidthCm
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>count  150.000000     150.000000    150.000000     150.000000    150.000000
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>mean    75.500000       5.843333      3.054000       3.758667      1.198667
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>std     43.445368       0.828066      0.433594       1.764420      0.763161
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>min      1.000000       4.300000      2.000000       1.000000      0.100000
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>25%     38.250000       5.100000      2.800000       1.600000      0.300000
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>50%     75.500000       5.800000      3.000000       4.350000      1.300000
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>75%    112.750000       6.400000      3.300000       5.100000      1.800000
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>max    150.000000       7.900000      4.400000       6.900000      2.500000
</code></pre></div><p></p>
<p><strong>¿Qué significa cada línea?</strong></p>
<ul>
<li><strong>count:</strong> Número de valores no-nulos (verificar valores faltantes)</li>
<li><strong>mean:</strong> Promedio. Si es muy diferente de la mediana, hay sesgos</li>
<li><strong>std:</strong> Desviación estándar. Mide dispersión. Alto = datos heterogéneos</li>
<li><strong>min/max:</strong> Rango. Busca valores imposibles o sospechosos</li>
<li><strong>25%, 50%, 75%:</strong> Cuartiles. Son robustos a outliers, a diferencia de media</li>
</ul>
<hr>
<h3 id="22-distribuciones-univariadas">2.2 Distribuciones Univariadas<a class="headerlink" href="#22-distribuciones-univariadas" title="Permanent link">¶</a></h3>
<p><strong>Un gráfico vale más que 1000 números.</strong></p>
<p>Visualizar cómo se distribuye cada variable te muestra:
- Forma (normal, sesgada, bimodal)
- Concentración de valores
- Presencia de outliers</p>
<p></p><div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'SepalLengthCm'</span><span class="p">,</span> <span class="s1">'SepalWidthCm'</span><span class="p">,</span> <span class="s1">'PetalLengthCm'</span><span class="p">,</span> <span class="s1">'PetalWidthCm'</span><span class="p">]</span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'skyblue'</span><span class="p">,</span> <span class="s1">'lightgreen'</span><span class="p">,</span> <span class="s1">'salmon'</span><span class="p">,</span> <span class="s1">'plum'</span><span class="p">]</span>
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">feature</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">features</span><span class="p">):</span>
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">idx</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">idx</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a>
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>    <span class="c1"># Histograma con KDE</span>
<a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a>    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">feature</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
<a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Distribución de </span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
<a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Valor'</span><span class="p">)</span>
<a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Frecuencia'</span><span class="p">)</span>
<a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a>
<a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a><span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'./images/distribuciones_univariadas.png'</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">'tight'</span><span class="p">)</span>
<a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a><span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>
Output esperado:
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../images/distribuciones_univariadas.png" data-desc-position="bottom"><img alt="Distribuciones Univariadas" src="../images/distribuciones_univariadas.png"></a><p></p>
<ul>
<li><strong>Forma normal (campana):</strong> Indicador de datos bien comportados</li>
<li><strong>Sesgada (skewed):</strong> Cola larga en un lado. Petal length está sesgada a la izquierda (muchos flores pequeñas)</li>
<li><strong>Bimodal:</strong> Dos picos. Sugiere dos subgrupos (en Iris: especies con flores grandes vs pequeñas)</li>
</ul>
<hr>
<h3 id="23-box-plots">2.3 Box Plots<a class="headerlink" href="#23-box-plots" title="Permanent link">¶</a></h3>
<p><strong>Resumen rápido de distribución y outliers:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">feature</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">features</span><span class="p">):</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>    <span class="n">axes</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">feature</span><span class="p">])</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>    <span class="n">axes</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">feature</span><span class="p">)</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>    <span class="n">axes</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Valor'</span><span class="p">)</span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'images/boxplots.png'</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">'tight'</span><span class="p">)</span>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>
<p>Output esperado:
</p><figure id="_figure-1"><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../images/boxplots.png" data-desc-position="bottom"><img alt="Box Plots" src="../images/boxplots.png"></a><figcaption>Figura 1: Box Plots</figcaption></figure><p></p>
<p><strong>Interpretación:</strong>
- <strong>Línea central:</strong> Mediana (Q2)
- <strong>Caja:</strong> IQR (50% central de datos)
- <strong>Bigotes:</strong> Límites (Q1 - 1.5×IQR hasta Q3 + 1.5×IQR)
- <strong>Puntos:</strong> Outliers</p>
<p>Para Iris, notarás que <strong>petal_length y petal_width tienen distribuciones claramente bimodales</strong> → Diferentes especies tienen tamaños muy distintos.</p>
<hr>
<h3 id="24-relaciones-bivariadas">2.4 Relaciones Bivariadas<a class="headerlink" href="#24-relaciones-bivariadas" title="Permanent link">¶</a></h3>
<p><strong>¿Cómo se relacionan dos variables?</strong></p>
<p>La correlación mide relación lineal:
- <strong>r = 1:</strong> Perfecta positiva (X aumenta → Y aumenta)
- <strong>r = 0:</strong> Sin relación lineal
- <strong>r = -1:</strong> Perfecta negativa (X aumenta → Y disminuye)</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c1"># Matriz de correlación</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="n">corr_matrix</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">corr_matrix</span><span class="p">)</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="c1"># Visualización</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr_matrix</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">'.2f'</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'coolwarm'</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>            <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">cbar_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">'label'</span><span class="p">:</span> <span class="s1">'Correlación'</span><span class="p">})</span>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Matriz de Correlación - Iris Features'</span><span class="p">)</span>
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'./images/correlacion_matrix.png'</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">'tight'</span><span class="p">)</span>
<a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>
<p><strong>Output esperado:</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>SepalLengthCm  SepalWidthCm  PetalLengthCm  PetalWidthCm
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>SepalLengthCm       1.000000     -0.109369       0.871754      0.817954
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>SepalWidthCm       -0.109369      1.000000      -0.420516     -0.356544
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>PetalLengthCm       0.871754     -0.420516       1.000000      0.962757
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>PetalWidthCm        0.817954     -0.356544       0.962757      1.000000
</code></pre></div>
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../images/correlacion_matrix.png" data-desc-position="bottom"><img alt="Matriz de Correlación" src="../images/correlacion_matrix.png"></a><p></p>
<p><strong>Interpretación:</strong>
- <strong>Sepal_length vs petal_length: 0.87</strong> → Fuerte relación positiva (flores grandes en ambas medidas)
- <strong>Sepal_width vs petal_length: -0.42</strong> → Relación negativa moderada (flores anchas tienden a ser pequeñas en pétalos)
- <strong>Petal_length vs petal_width: 0.96</strong> → Casi perfecta (pétalos grandes implican anchos grandes)</p>
<hr>
<h3 id="25-scatter-plots">2.5 Scatter Plots<a class="headerlink" href="#25-scatter-plots" title="Permanent link">¶</a></h3>
<p><strong>Para visualizar relaciones bivariadas directamente:</strong></p>
<p></p><div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="c1"># Scatter simple: sepal_length vs petal_length</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'sepal_length'</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">'petal_length'</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Sepal Length'</span><span class="p">)</span>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Petal Length'</span><span class="p">)</span>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Correlación: 0.87 (fuerte positiva)'</span><span class="p">)</span>
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a>
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="c1"># Scatter coloreado por species</span>
<a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a><span class="k">for</span> <span class="n">species</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">'species'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
<a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a>    <span class="n">mask</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'species'</span><span class="p">]</span> <span class="o">==</span> <span class="n">species</span>
<a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a>    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">mask</span><span class="p">][</span><span class="s1">'sepal_length'</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">mask</span><span class="p">][</span><span class="s1">'petal_length'</span><span class="p">],</span> 
<a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a>                    <span class="n">label</span><span class="o">=</span><span class="n">species</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Sepal Length'</span><span class="p">)</span>
<a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Petal Length'</span><span class="p">)</span>
<a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Por especie'</span><span class="p">)</span>
<a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<a id="__codelineno-13-20" name="__codelineno-13-20" href="#__codelineno-13-20"></a>
<a id="__codelineno-13-21" name="__codelineno-13-21" href="#__codelineno-13-21"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a id="__codelineno-13-22" name="__codelineno-13-22" href="#__codelineno-13-22"></a><span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'./images/scatter_plots.png'</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">'tight'</span><span class="p">)</span>
<a id="__codelineno-13-23" name="__codelineno-13-23" href="#__codelineno-13-23"></a><span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../images/scatter_plots.png" data-desc-position="bottom"><img alt="Scatter Plots" src="../images/scatter_plots.png"></a><p></p>
<p><strong>¿Por qué colorear por species?</strong> Ves que Iris setosa (pequeña) se agrupa en esquina inferior-izquierda, mientras que Iris virginica (grande) en esquina superior-derecha. <strong>Las clases son linealmente separables</strong> → Un clasificador lineal funcionará bien.</p>
<hr>
<h3 id="26-multicolinealidad">2.6 Multicolinealidad<a class="headerlink" href="#26-multicolinealidad" title="Permanent link">¶</a></h3>
<p><strong>¿Por qué importa?</strong></p>
<p>Multicolinealidad = Dos features muy correlacionadas. En regresión/clasificación lineal, causa:
- Coeficientes inestables (pequeños cambios en datos → grandes cambios en coeficientes)
- Dificultad interpretando importancia de features
- Overfitting potencial</p>
<p><strong>Detección:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c1"># Mira correlaciones &gt; 0.9</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">corr_matrix</span><span class="p">[</span><span class="n">corr_matrix</span> <span class="o">&gt;</span> <span class="mf">0.9</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="c1"># En Iris: petal_length y petal_width están altamente correlacionadas (0.96)</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="c1"># Pero con 4 features, no es crítico</span>
</code></pre></div>
<p><strong>Decisión:</strong> En Iris, no es problema (dataset pequeño, modelos simples). En datasets grandes, considera:
- Eliminar una de las features correlacionadas
- Usar regularización (L1/L2)
- PCA (reducción de dimensionalidad)</p>
<hr>
<h3 id="27-imbalance-y-representatividad">2.7 Imbalance y Representatividad<a class="headerlink" href="#27-imbalance-y-representatividad" title="Permanent link">¶</a></h3>
<p><strong>¿Están todas las clases bien representadas?</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="c1"># Conteo de clases</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'species'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="c1"># Visualización</span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="n">df</span><span class="p">[</span><span class="s1">'species'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">'bar'</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">'blue'</span><span class="p">,</span> <span class="s1">'orange'</span><span class="p">,</span> <span class="s1">'green'</span><span class="p">])</span>
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Distribución de clases en Iris'</span><span class="p">)</span>
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Especie'</span><span class="p">)</span>
<a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Cantidad'</span><span class="p">)</span>
<a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a><span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'./images/class_distribution.png'</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">'tight'</span><span class="p">)</span>
<a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a><span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>
<p><strong>Output:</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>species
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>setosa        50
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>versicolor    50
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>virginica     50
</code></pre></div><p></p>
<p></p><figure id="_figure-2"><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../images/class_distribution.png" data-desc-position="bottom"><img alt="Distribución de Clases" src="../images/class_distribution.png"></a><figcaption>Figura 2: Distribución de Clases</figcaption></figure><p></p>
<p><strong>Interpretación para Iris:</strong> Perfectamente balanceado (50 cada una). En la vida real, raro. Titanic, por ejemplo, tiene ~62% supervivientes, 38% no. En dataset muy desbalanceado (ej: detección de fraude con 0.1% fraude), métricas como Accuracy engañan.</p>
<hr>
<h3 id="28-patrones-anomalias-e-insights">2.8 Patrones, Anomalías e Insights<a class="headerlink" href="#28-patrones-anomalias-e-insights" title="Permanent link">¶</a></h3>
<p><strong>Último paso del EDA: Storytelling.</strong></p>
<p>Pregúntate:
- ¿Cuál es la característica más importante para predecir la clase?
- ¿Hay grupos naturales en los datos?
- ¿Qué anomalías notaste?</p>
<p><strong>Para Iris:</strong>
- Petal_length es el mejor discriminante entre especies
- Las clases son casi linealmente separables
- No hay outliers obvios
- Dataset es pequeño pero limpio</p>
<p><strong>Visualización final: PCA para contexto (opcional, solo visualización)</strong></p>
<p></p><div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="n">X_pca</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">features</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a><span class="k">for</span> <span class="n">species</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">'Species'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
<a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>    <span class="n">mask</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'Species'</span><span class="p">]</span> <span class="o">==</span> <span class="n">species</span>
<a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_pca</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_pca</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">species</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a>
<a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">'PC1 (</span><span class="si">{</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.2%</span><span class="si">}</span><span class="s1"> varianza)'</span><span class="p">)</span>
<a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">'PC2 (</span><span class="si">{</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">.2%</span><span class="si">}</span><span class="s1"> varianza)'</span><span class="p">)</span>
<a id="__codelineno-17-14" name="__codelineno-17-14" href="#__codelineno-17-14"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Proyección PCA 2D - Iris Species'</span><span class="p">)</span>
<a id="__codelineno-17-15" name="__codelineno-17-15" href="#__codelineno-17-15"></a><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<a id="__codelineno-17-16" name="__codelineno-17-16" href="#__codelineno-17-16"></a><span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<a id="__codelineno-17-17" name="__codelineno-17-17" href="#__codelineno-17-17"></a>
<a id="__codelineno-17-18" name="__codelineno-17-18" href="#__codelineno-17-18"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a id="__codelineno-17-19" name="__codelineno-17-19" href="#__codelineno-17-19"></a><span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'./images/pca_visualization.png'</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">'tight'</span><span class="p">)</span>
<a id="__codelineno-17-20" name="__codelineno-17-20" href="#__codelineno-17-20"></a><span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../images/pca_visualization.png" data-desc-position="bottom"><img alt="PCA Visualization" src="../images/pca_visualization.png"></a><p></p>
<hr>
<h2 id="3-train-test-split-y-estandarizacion">3. Train-Test Split y Estandarización<a class="headerlink" href="#3-train-test-split-y-estandarizacion" title="Permanent link">¶</a></h2>
<h3 id="31-separacion-train-test">3.1 Separación Train-Test<a class="headerlink" href="#31-separacion-train-test" title="Permanent link">¶</a></h3>
<p><strong>¿Por qué es crítico?</strong></p>
<p>Entrenar y evaluar en los <strong>mismos datos</strong> es trampa. El modelo memoriza. La métrica resultante <strong>no estima performance en datos nuevos</strong> (que es lo que importa).</p>
<p><strong>Analogía:</strong> Es como estudiante que memoriza las preguntas exactas de un examen pasado. Cuando llega el examen real con preguntas similares pero no idénticas, se hunde.</p>
<p></p><div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="c1"># Split 80-20</span>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">features</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'species'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span>
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="p">)</span>
<a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a>
<a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Train: </span><span class="si">{</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">, Test: </span><span class="si">{</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a><span class="c1"># Train: (120, 4), Test: (30, 4)</span>
<a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a>
<a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a><span class="c1"># stratify=y asegura que cada split tenga proporción similar de clases</span>
<a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Train - setosa: </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">y_train</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">'setosa'</span><span class="p">)</span><span class="si">}</span><span class="s2">/120"</span><span class="p">)</span>
<a id="__codelineno-18-16" name="__codelineno-18-16" href="#__codelineno-18-16"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Test - setosa: </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">y_test</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">'setosa'</span><span class="p">)</span><span class="si">}</span><span class="s2">/30"</span><span class="p">)</span>
</code></pre></div>
<strong>Output esperado:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>Train: (120, 4), Test: (30, 4)
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>Train - setosa: 0/120
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>Test - setosa: 0/30
</code></pre></div><p></p>
<div class="admonition warning">
<p class="admonition-title">NUNCA hagas normalización/imputación antes de splitear</p>
<p><strong>INCORRECTO:</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="n">X_normalized</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>  <span class="c1"># FIT EN TODO</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="o">...</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_normalized</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</code></pre></div><p></p>
<p><strong>CORRECTO:</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="o">...</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>  <span class="c1"># FIT solo en train</span>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="n">X_train_norm</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="n">X_test_norm</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div><p></p>
</div>
<hr>
<h3 id="32-estandarizacion-del-conjunto-de-entrenamiento">3.2 Estandarización del Conjunto de Entrenamiento<a class="headerlink" href="#32-estandarizacion-del-conjunto-de-entrenamiento" title="Permanent link">¶</a></h3>
<p>Recuerda: La estandarización es <strong>crítica para modelos lineales</strong> (logistic regression, SVM, etc.).</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>  <span class="c1"># FIT SOLO en train</span>
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a>
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="n">X_train_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="n">X_test_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a>
<a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a><span class="c1"># Verificar</span>
<a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Train mean: </span><span class="si">{</span><span class="n">X_train_scaled</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>  <span class="c1"># ~0</span>
<a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Train std: </span><span class="si">{</span><span class="n">X_train_scaled</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>    <span class="c1"># ~1</span>
<a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Test mean: </span><span class="si">{</span><span class="n">X_test_scaled</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>    <span class="c1"># No es ~0 (datos nuevos)</span>
</code></pre></div>
<p><strong>Output esperado:</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>Train mean: [-1.20829273e-15 -2.53315887e-15  1.48029737e-16  1.55246186e-15]
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>Train std: [1. 1. 1. 1.]
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>Test mean: [ 0.00995126  0.11078352 -0.03456365 -0.03615399]
</code></pre></div><p></p>
<div class="admonition info">
<p class="admonition-title">¿Por qué test no tiene mean=0?</p>
<p>El scaler fue ajustado con estadísticas del train. Al aplicarlo al test (datos nuevos), el test conserva su propia distribución. Esto es <strong>correcto</strong>: validamos con datos en su distribución real.</p>
</div>
<hr>
<h3 id="33-modelo-regresion-logistica">3.3 Modelo: Regresión Logística<a class="headerlink" href="#33-modelo-regresion-logistica" title="Permanent link">¶</a></h3>
<p><strong>¿Qué es?</strong></p>
<p>A pesar del nombre, es un <strong>clasificador</strong>, no regresión. Predice probabilidades de pertenencia a clases.</p>
<p><strong>Conceptualmente:</strong>
- Para 2 clases: P(Y=1) = sigmoid(w₀ + w₁X₁ + w₂X₂ + ...)
- Para 3+ clases (como Iris): Softmax (extensión de sigmoid)</p>
<p><strong>Interpretación:</strong>
- <strong>Coeficientes positivos:</strong> Aumentan probabilidad de la clase
- <strong>Coeficientes negativos:</strong> Disminuyen probabilidad</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="c1"># Crear modelo</span>
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="n">model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span>
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>    <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a>    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
<a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a>    <span class="n">multi_class</span><span class="o">=</span><span class="s1">'multinomial'</span>  <span class="c1"># Para 3+ clases</span>
<a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a><span class="p">)</span>
<a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a>
<a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a><span class="c1"># Entrenar</span>
<a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a>
<a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a><span class="c1"># Predicciones</span>
<a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a><span class="n">y_pred_train</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">)</span>
<a id="__codelineno-24-15" name="__codelineno-24-15" href="#__codelineno-24-15"></a><span class="n">y_pred_test</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)</span>
<a id="__codelineno-24-16" name="__codelineno-24-16" href="#__codelineno-24-16"></a>
<a id="__codelineno-24-17" name="__codelineno-24-17" href="#__codelineno-24-17"></a><span class="c1"># Probabilidades</span>
<a id="__codelineno-24-18" name="__codelineno-24-18" href="#__codelineno-24-18"></a><span class="n">y_proba_test</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)</span>
<a id="__codelineno-24-19" name="__codelineno-24-19" href="#__codelineno-24-19"></a><span class="nb">print</span><span class="p">(</span><span class="n">y_proba_test</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>  <span class="c1"># [prob_setosa, prob_versicolor, prob_virginica]</span>
</code></pre></div>
<p><strong>Output esperado (probabilidades):</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>Probabilidades de las primeras 5 muestras del test:
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>[
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>    [9.79355498e-01 2.06441434e-02 3.58223033e-07]
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a>    [3.77309225e-03 3.69498929e-01 6.26727979e-01]
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a>    [1.49647017e-01 8.41581277e-01 8.77170654e-03]
<a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a>    [9.58890418e-02 8.94120385e-01 9.99057342e-03]
<a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a>    [9.88807815e-01 1.11920151e-02 1.69552410e-07]
<a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a>]
</code></pre></div><p></p>
<hr>
<h3 id="34-metricas-de-clasificacion">3.4 Métricas de Clasificación<a class="headerlink" href="#34-metricas-de-clasificacion" title="Permanent link">¶</a></h3>
<div class="admonition danger">
<p class="admonition-title">⚠️ ATENCIÓN</p>
<p>Las métricas que ves a continuación son <strong>para CLASIFICACIÓN</strong>.</p>
<p>Para <strong>REGRESIÓN</strong>, usarías:
- <strong>MSE (Mean Squared Error):</strong> Promedio de (y_true - y_pred)²
- <strong>RMSE (Root MSE):</strong> √MSE (misma escala que y)
- <strong>MAE (Mean Absolute Error):</strong> Promedio de |y_true - y_pred|</p>
</div>
<p><strong>Clasificación - Métricas principales:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="p">(</span>
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>    <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">,</span> 
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>    <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">classification_report</span>
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="p">)</span>
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="c1"># Accuracy: % correcto</span>
<a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a><span class="n">acc</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_test</span><span class="p">)</span>
<a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Accuracy: </span><span class="si">{</span><span class="n">acc</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>  <span class="c1"># 1.0 (perfecto en este dataset)</span>
<a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a>
<a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a><span class="c1"># Precision (para clase i): TP / (TP + FP) - "de lo que predije positivo, cuánto fue correcto"</span>
<a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a><span class="c1"># Recall (para clase i): TP / (TP + FN) - "de los verdaderos positivos, cuántos encontré"</span>
<a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a><span class="c1">#</span>
<a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a><span class="c1">#  F1: Media armónica de Precision y Recall - "balance entre ambos"</span>
<a id="__codelineno-26-14" name="__codelineno-26-14" href="#__codelineno-26-14"></a>
<a id="__codelineno-26-15" name="__codelineno-26-15" href="#__codelineno-26-15"></a><span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_test</span><span class="p">))</span>
</code></pre></div>
<p><strong>Output típico:</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>              Accuracy: 0.9333
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a>                 precision    recall  f1-score   support
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a>    Iris-setosa       1.00      1.00      1.00        10
<a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a>Iris-versicolor       0.90      0.90      0.90        10
<a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a> Iris-virginica       0.90      0.90      0.90        10
<a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a>
<a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a>       accuracy                           0.93        30
<a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a>      macro avg       0.93      0.93      0.93        30
<a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a>   weighted avg       0.93      0.93      0.93        30
</code></pre></div><p></p>
<p><strong>Matriz de confusión:</strong></p>
<p></p><div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="n">cm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_test</span><span class="p">)</span>
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">cm</span><span class="p">)</span>
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="c1"># Visualización</span>
<a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a><span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">'d'</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'Blues'</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
<a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a>            <span class="n">xticklabels</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">classes_</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">classes_</span><span class="p">)</span>
<a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Predicho'</span><span class="p">)</span>
<a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Real'</span><span class="p">)</span>
<a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Matriz de Confusión'</span><span class="p">)</span>
<a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a><span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'./images/confusion_matrix.png'</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">'tight'</span><span class="p">)</span>
<a id="__codelineno-28-13" name="__codelineno-28-13" href="#__codelineno-28-13"></a><span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../images/confusion_matrix.png" data-desc-position="bottom"><img alt="Matriz de Confusión" src="../images/confusion_matrix.png"></a><p></p>
<p><strong>Interpretación:</strong>
- Diagonal principal: Aciertos
- Fuera de diagonal: Errores</p>
<hr>
<h3 id="35-validacion-cruzada">3.5 Validación Cruzada<a class="headerlink" href="#35-validacion-cruzada" title="Permanent link">¶</a></h3>
<p><strong>Problema:</strong> Un único split train-test puede ser afortunado (test fácil) o desafortunado (test difícil).</p>
<p><strong>Solución:</strong> Validación cruzada (k-fold)</p>
<p>Divide datos en k folds. Entrena k modelos, cada uno dejando un fold para validar:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_validate</span>
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>
<a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a><span class="c1"># 5-fold cross-validation</span>
<a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a><span class="n">cv_results</span> <span class="o">=</span> <span class="n">cross_validate</span><span class="p">(</span>
<a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a>    <span class="n">model</span><span class="p">,</span>
<a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a>    <span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span>
<a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a>    <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a>    <span class="n">scoring</span><span class="o">=</span><span class="p">[</span><span class="s1">'accuracy'</span><span class="p">,</span> <span class="s1">'precision_weighted'</span><span class="p">,</span> <span class="s1">'recall_weighted'</span><span class="p">,</span> <span class="s1">'f1_weighted'</span><span class="p">]</span>
<a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a><span class="p">)</span>
<a id="__codelineno-29-10" name="__codelineno-29-10" href="#__codelineno-29-10"></a>
<a id="__codelineno-29-11" name="__codelineno-29-11" href="#__codelineno-29-11"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"CV Accuracy: </span><span class="si">{</span><span class="n">cv_results</span><span class="p">[</span><span class="s1">'test_accuracy'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> ± </span><span class="si">{</span><span class="n">cv_results</span><span class="p">[</span><span class="s1">'test_accuracy'</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a id="__codelineno-29-12" name="__codelineno-29-12" href="#__codelineno-29-12"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"CV F1: </span><span class="si">{</span><span class="n">cv_results</span><span class="p">[</span><span class="s1">'test_f1_weighted'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> ± </span><span class="si">{</span><span class="n">cv_results</span><span class="p">[</span><span class="s1">'test_f1_weighted'</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div>
<p><strong>Output:</strong>
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>CV Accuracy: 0.9583 ± 0.0264
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>CV F1: 0.9580 ± 0.0268
</code></pre></div><p></p>
<div class="admonition info">
<p class="admonition-title">¿Qué significa?</p>
<p>Media 95.83% ± 2.64% → En promedio, 95.83%, pero varía ±2.68% entre folds. <strong>Desviación baja = modelo estable.</strong></p>
</div>
<hr>
<h2 id="4-pipelines-en-machine-learning">4. Pipelines en Machine Learning<a class="headerlink" href="#4-pipelines-en-machine-learning" title="Permanent link">¶</a></h2>
<p>Los <strong>pipelines</strong> encadenan múltiples transformaciones y modelos en un único objeto reutilizable y reproducible. Es la forma profesional de hacer ML.</p>
<h3 id="41-por-que-pipelines">4.1 ¿Por qué Pipelines?<a class="headerlink" href="#41-por-que-pipelines" title="Permanent link">¶</a></h3>
<p><strong>Sin pipeline (Frágil):</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="n">X_train_s</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a><span class="n">X_test_s</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a>
<a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a><span class="n">model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_s</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a><span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_s</span><span class="p">)</span>
</code></pre></div>
<p><strong>Problemas:</strong>
- Fácil olvidar pasos
- Data leakage accidental
- Código repetitivo
- Difícil de reproducir</p>
<p><strong>Con pipeline (Profesional):</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a>
<a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a><span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
<a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a>    <span class="p">(</span><span class="s1">'scaler'</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
<a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a>    <span class="p">(</span><span class="s1">'model'</span><span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">))</span>
<a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a><span class="p">])</span>
<a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a>
<a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a><span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<a id="__codelineno-32-11" name="__codelineno-32-11" href="#__codelineno-32-11"></a><span class="n">y_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div>
<p><strong>Ventajas:</strong>
- Código limpio y legible
- Imposible data leakage
- Fácil cambiar componentes
- Funciona automáticamente con validación cruzada y grid search
- Production-ready</p>
<h3 id="42-pipeline-basico">4.2 Pipeline Básico<a class="headerlink" href="#42-pipeline-basico" title="Permanent link">¶</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">f1_score</span>
<a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a>
<a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a><span class="c1"># Crear pipeline</span>
<a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a><span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
<a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a>    <span class="p">(</span><span class="s1">'scaler'</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
<a id="__codelineno-33-9" name="__codelineno-33-9" href="#__codelineno-33-9"></a>    <span class="p">(</span><span class="s1">'logistic'</span><span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">multi_class</span><span class="o">=</span><span class="s1">'multinomial'</span><span class="p">))</span>
<a id="__codelineno-33-10" name="__codelineno-33-10" href="#__codelineno-33-10"></a><span class="p">])</span>
<a id="__codelineno-33-11" name="__codelineno-33-11" href="#__codelineno-33-11"></a>
<a id="__codelineno-33-12" name="__codelineno-33-12" href="#__codelineno-33-12"></a><span class="c1"># Entrenar</span>
<a id="__codelineno-33-13" name="__codelineno-33-13" href="#__codelineno-33-13"></a><span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<a id="__codelineno-33-14" name="__codelineno-33-14" href="#__codelineno-33-14"></a>
<a id="__codelineno-33-15" name="__codelineno-33-15" href="#__codelineno-33-15"></a><span class="c1"># Predecir</span>
<a id="__codelineno-33-16" name="__codelineno-33-16" href="#__codelineno-33-16"></a><span class="n">y_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<a id="__codelineno-33-17" name="__codelineno-33-17" href="#__codelineno-33-17"></a><span class="n">y_proba</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<a id="__codelineno-33-18" name="__codelineno-33-18" href="#__codelineno-33-18"></a>
<a id="__codelineno-33-19" name="__codelineno-33-19" href="#__codelineno-33-19"></a><span class="c1"># Evaluar</span>
<a id="__codelineno-33-20" name="__codelineno-33-20" href="#__codelineno-33-20"></a><span class="n">acc</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-33-21" name="__codelineno-33-21" href="#__codelineno-33-21"></a><span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">'weighted'</span><span class="p">)</span>
<a id="__codelineno-33-22" name="__codelineno-33-22" href="#__codelineno-33-22"></a>
<a id="__codelineno-33-23" name="__codelineno-33-23" href="#__codelineno-33-23"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Accuracy: </span><span class="si">{</span><span class="n">acc</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a id="__codelineno-33-24" name="__codelineno-33-24" href="#__codelineno-33-24"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"F1: </span><span class="si">{</span><span class="n">f1</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div>
<h3 id="43-columntransformer-para-multiples-tipos-de-datos">4.3 ColumnTransformer (para múltiples tipos de datos)<a class="headerlink" href="#43-columntransformer-para-multiples-tipos-de-datos" title="Permanent link">¶</a></h3>
<p>Aunque Iris solo tiene numéricas, enseñamos el patrón completo:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="kn">from</span> <span class="nn">sklearn.compose</span> <span class="kn">import</span> <span class="n">ColumnTransformer</span>
<a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a>
<a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a><span class="c1"># Definir tipos de features</span>
<a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a><span class="n">numeric_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'sepal_length'</span><span class="p">,</span> <span class="s1">'sepal_width'</span><span class="p">,</span> <span class="s1">'petal_length'</span><span class="p">,</span> <span class="s1">'petal_width'</span><span class="p">]</span>
<a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a>
<a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a><span class="c1"># Transformer para numéricas</span>
<a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a><span class="n">numeric_transformer</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
<a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a>    <span class="p">(</span><span class="s1">'scaler'</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">())</span>
<a id="__codelineno-34-10" name="__codelineno-34-10" href="#__codelineno-34-10"></a><span class="p">])</span>
<a id="__codelineno-34-11" name="__codelineno-34-11" href="#__codelineno-34-11"></a>
<a id="__codelineno-34-12" name="__codelineno-34-12" href="#__codelineno-34-12"></a><span class="c1"># Combinar transformers</span>
<a id="__codelineno-34-13" name="__codelineno-34-13" href="#__codelineno-34-13"></a><span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">([</span>
<a id="__codelineno-34-14" name="__codelineno-34-14" href="#__codelineno-34-14"></a>    <span class="p">(</span><span class="s1">'num'</span><span class="p">,</span> <span class="n">numeric_transformer</span><span class="p">,</span> <span class="n">numeric_features</span><span class="p">)</span>
<a id="__codelineno-34-15" name="__codelineno-34-15" href="#__codelineno-34-15"></a><span class="p">])</span>
<a id="__codelineno-34-16" name="__codelineno-34-16" href="#__codelineno-34-16"></a>
<a id="__codelineno-34-17" name="__codelineno-34-17" href="#__codelineno-34-17"></a><span class="c1"># Pipeline completo</span>
<a id="__codelineno-34-18" name="__codelineno-34-18" href="#__codelineno-34-18"></a><span class="n">full_pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
<a id="__codelineno-34-19" name="__codelineno-34-19" href="#__codelineno-34-19"></a>    <span class="p">(</span><span class="s1">'preprocessor'</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
<a id="__codelineno-34-20" name="__codelineno-34-20" href="#__codelineno-34-20"></a>    <span class="p">(</span><span class="s1">'model'</span><span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">))</span>
<a id="__codelineno-34-21" name="__codelineno-34-21" href="#__codelineno-34-21"></a><span class="p">])</span>
<a id="__codelineno-34-22" name="__codelineno-34-22" href="#__codelineno-34-22"></a>
<a id="__codelineno-34-23" name="__codelineno-34-23" href="#__codelineno-34-23"></a><span class="c1"># Usar igual que antes</span>
<a id="__codelineno-34-24" name="__codelineno-34-24" href="#__codelineno-34-24"></a><span class="n">full_pipeline</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<a id="__codelineno-34-25" name="__codelineno-34-25" href="#__codelineno-34-25"></a><span class="n">y_pred</span> <span class="o">=</span> <span class="n">full_pipeline</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div>
<h3 id="44-pipeline-con-gridsearchcv">4.4 Pipeline con GridSearchCV<a class="headerlink" href="#44-pipeline-con-gridsearchcv" title="Permanent link">¶</a></h3>
<p><strong>Tunear automáticamente TODO:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
<a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a>
<a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a><span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
<a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a>    <span class="p">(</span><span class="s1">'scaler'</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
<a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a>    <span class="p">(</span><span class="s1">'model'</span><span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">))</span>
<a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a><span class="p">])</span>
<a id="__codelineno-35-7" name="__codelineno-35-7" href="#__codelineno-35-7"></a>
<a id="__codelineno-35-8" name="__codelineno-35-8" href="#__codelineno-35-8"></a><span class="c1"># Parámetros a tunear</span>
<a id="__codelineno-35-9" name="__codelineno-35-9" href="#__codelineno-35-9"></a><span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-35-10" name="__codelineno-35-10" href="#__codelineno-35-10"></a>    <span class="s1">'model__C'</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
<a id="__codelineno-35-11" name="__codelineno-35-11" href="#__codelineno-35-11"></a>    <span class="s1">'model__max_iter'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">]</span>
<a id="__codelineno-35-12" name="__codelineno-35-12" href="#__codelineno-35-12"></a><span class="p">}</span>
<a id="__codelineno-35-13" name="__codelineno-35-13" href="#__codelineno-35-13"></a>
<a id="__codelineno-35-14" name="__codelineno-35-14" href="#__codelineno-35-14"></a><span class="c1"># Grid search</span>
<a id="__codelineno-35-15" name="__codelineno-35-15" href="#__codelineno-35-15"></a><span class="n">grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipe</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">'f1_weighted'</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-35-16" name="__codelineno-35-16" href="#__codelineno-35-16"></a><span class="n">grid</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<a id="__codelineno-35-17" name="__codelineno-35-17" href="#__codelineno-35-17"></a>
<a id="__codelineno-35-18" name="__codelineno-35-18" href="#__codelineno-35-18"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Mejor C: </span><span class="si">{</span><span class="n">grid</span><span class="o">.</span><span class="n">best_params_</span><span class="p">[</span><span class="s1">'model__C'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a id="__codelineno-35-19" name="__codelineno-35-19" href="#__codelineno-35-19"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Mejor max_iter: </span><span class="si">{</span><span class="n">grid</span><span class="o">.</span><span class="n">best_params_</span><span class="p">[</span><span class="s1">'model__max_iter'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a id="__codelineno-35-20" name="__codelineno-35-20" href="#__codelineno-35-20"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Mejor score CV: </span><span class="si">{</span><span class="n">grid</span><span class="o">.</span><span class="n">best_score_</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<a id="__codelineno-35-21" name="__codelineno-35-21" href="#__codelineno-35-21"></a>
<a id="__codelineno-35-22" name="__codelineno-35-22" href="#__codelineno-35-22"></a><span class="c1"># Predecir con mejor modelo</span>
<a id="__codelineno-35-23" name="__codelineno-35-23" href="#__codelineno-35-23"></a><span class="n">y_pred</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div>
<h3 id="45-ventajas-de-pipelines-tabla-resumen">4.5 Ventajas de Pipelines - Tabla Resumen<a class="headerlink" href="#45-ventajas-de-pipelines-tabla-resumen" title="Permanent link">¶</a></h3>
<table>
<thead>
<tr>
<th>Aspecto</th>
<th>Sin Pipeline</th>
<th>Con Pipeline</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Data leakage</strong></td>
<td>Fácil olvidarse</td>
<td>Imposible</td>
</tr>
<tr>
<td><strong>Reproducibilidad</strong></td>
<td>Frágil</td>
<td>Robusta</td>
</tr>
<tr>
<td><strong>Código</strong></td>
<td>Repetitivo</td>
<td>Limpio</td>
</tr>
<tr>
<td><strong>Cambiar componentes</strong></td>
<td>Tedioso</td>
<td>Una línea</td>
</tr>
<tr>
<td><strong>CV/GridSearch</strong></td>
<td>Manual</td>
<td>Automático</td>
</tr>
<tr>
<td><strong>Producción</strong></td>
<td>Frágil</td>
<td>Ready</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="5-tareas-para-casa">5. Tareas para Casa<a class="headerlink" href="#5-tareas-para-casa" title="Permanent link">¶</a></h2>
<h3 id="objetivo">Objetivo<a class="headerlink" href="#objetivo" title="Permanent link">¶</a></h3>
<p>Replicar el flujo completo de ML en un dataset de tu elección.</p>
<h3 id="opciones-de-dataset">Opciones de Dataset<a class="headerlink" href="#opciones-de-dataset" title="Permanent link">¶</a></h3>
<p><strong>Opción 1: Titanic</strong> (Recomendado para empezar)
- 890 registros, 11 features
- Objetivo: Supervivencia (binaria)
- Desafío: Valores faltantes, mezcla de tipos
- Descarga: https://www.kaggle.com/c/titanic/data</p>
<p><strong>Opción 2: Wine Quality</strong>
- 1,600 registros, 12 features
- Objetivo: Calidad (0-10)
- Descarga: https://www.kaggle.com/datasets/yasserh/wine-quality-dataset</p>
<p><strong>Opción 3: Adult Income</strong>
- 32,500 registros, 14 features
- Objetivo: Ingresos &gt;50K (binaria)
- Descarga: https://archive.ics.uci.edu/ml/datasets/Adult</p>
<p><strong>Opción 4: Tu propio dataset</strong>
- Mínimo 2,000-4,000 registros
- Mínimo 10+ columnas
- Mezcla de numéricas y categóricas
- Variable objetivo clara</p>
<h3 id="estructura-de-entrega">Estructura de Entrega<a class="headerlink" href="#estructura-de-entrega" title="Permanent link">¶</a></h3>
<p><strong>MEMORÍA EN LATEX (Overleaf)</strong></p>





                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"></path></svg>
            Volver al principio
          </a>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.sections", "navigation.expand", "navigation.top", "navigation.indexes", "toc.follow", "toc.integrate", "search.suggest", "search.highlight", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.b78d2936.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.js"></script>
      
    
  
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>